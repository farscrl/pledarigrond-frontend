<div class="header-actions">
  <div>
    <span *ngIf="resultPage && resultPage.totalElements > 0">
      Displaying entries {{ (resultPage.number*resultPage.size) + 1 }}
      to {{ math.min((resultPage.number + 1) * resultPage.size, resultPage.totalElements) }}
      of {{ resultPage.totalElements }}
    </span>
  </div>
  <div class="options">
    <button nz-button nz-dropdown [nzDropdownMenu]="menu4">
      Columns
      <i nz-icon nzType="down"></i>
    </button>
    <nz-dropdown-menu #menu4="nzDropdownMenu">
      <ul nz-menu>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showUserColumn">User</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showFilterColumn">Filter</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showEntryColumn">Entry</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showOptionsColumn">Options</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showStateColumn">State</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showCreatedColumn">Creation date</label></li>
        <nz-divider></nz-divider>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showGermanColumn">German</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showRomanshColumn">Romansh</label></li>
        <li nz-menu-item><label nz-checkbox [(ngModel)]="showCommentColumn">Comment</label></li>
      </ul>
    </nz-dropdown-menu>

    <button nz-button nzType="default" (click)="exportResults()">
      <i nz-icon nzType="export"></i>
      Export
    </button>
    <button nz-button nzType="primary">
      <i nz-icon nzType="plus-square"></i>
      Add new entry
    </button>
  </div>

</div>

<nz-table
  nzNoAnimation
  [nzScroll]="{ x: '1100px' }"
  nzSize="small"
  #rowSelectionTable
  nzShowPagination="false"
  [nzData]="listOfLexEntries"
>
  <thead>
    <tr>
      <th [nzChecked]="checked" [nzIndeterminate]="indeterminate" (nzCheckedChange)="onAllChecked($event)" *ngIf="showCheckMultiple" nzLeft></th>
      <th *ngIf="showUserColumn" nzLeft nzWidth="120px">User</th>
      <th *ngIf="showFilterColumn" nzWidth="110px">Filter</th>
      <th *ngIf="showEntryColumn" nzWidth="200px">Entry</th>
      <th *ngIf="showOptionsColumn" nzWidth="110px">Actions</th>
      <th *ngIf="showStateColumn" nzWidth="120px">State</th>
      <th *ngIf="showCreatedColumn" nzWidth="120px">Created</th>
      <th *ngIf="showGermanColumn">German</th>
      <th *ngIf="showRomanshColumn">Romansh</th>
      <th *ngIf="showCommentColumn">Comment</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of listOfLexEntries" (click)="selectRow(data)" [class.selected]="data.selected">
      <td
        nzLeft
        [nzChecked]="setOfCheckedId.has(data.id)"
        [nzDisabled]="data.disabled"
        (nzCheckedChange)="onItemChecked(data.id, $event)"
        *ngIf="showCheckMultiple"
      ></td>
      <td *ngIf="showUserColumn" nzLeft class="small">
        <nz-tag [nzColor]="'geekblue'">{{ data.mostRecent.creatorRole }}</nz-tag><br>
        <ng-container *ngIf="data.mostRecent.userId">{{ data.mostRecent.userId }}</ng-container>
        {{ data.mostRecent.ip ? data.mostRecent.ip : '-' }}
      </td>
      <td *ngIf="showFilterColumn" class="button-column">
        <button nz-button nzSize="small" nzType="default" (click)="filterUser(data.mostRecent.ip); $event.stopPropagation();">Filter User</button>
        <button nz-button nzSize="small" nzType="default" (click)="filterVerifier(data.mostRecent.verifierId); $event.stopPropagation();" *ngIf="data.mostRecent.verifierId" style="margin-top: 4px;">Filter Verifier</button>
      </td>
      <td *ngIf="showEntryColumn">
        {{ data.mostRecent.entryValues.DStichwort }} â‡” {{ data.mostRecent.entryValues.RStichwort }}
      </td>
      <td *ngIf="showOptionsColumn" class="button-column">
        <button nz-button nzSize="small" nzType="primary">Edit</button><br>
        <button nz-button nzSize="small" nzType="primary" nzDanger>Delete</button>
      </td>
      <td *ngIf="showStateColumn" class="small">
        <nz-tag [nzColor]="'red'">{{ data.mostRecent.verification }}</nz-tag><br>
        <nz-tag>{{ data.mostRecent.status }}</nz-tag>
      </td>
      <td *ngIf="showCreatedColumn" class="small">
        {{ formateDate(data.mostRecent.timestamp) }}<br>
        {{ formateTime(data.mostRecent.timestamp) }}
      </td>
      <td *ngIf="showGermanColumn">{{ data.mostRecent.entryValues.DStichwort }}</td>
      <td *ngIf="showRomanshColumn">{{ data.mostRecent.entryValues.RStichwort }}</td>
      <td *ngIf="showCommentColumn">{{ data.mostRecent.entryValues.maalr_comment }}</td>
    </tr>
  </tbody>
</nz-table>


<div class="footer-actions">
  <div class="multi">
    <nz-switch
    [(ngModel)]="showCheckMultiple"
    [nzCheckedChildren]="checkedTemplate"
    [nzUnCheckedChildren]="unCheckedTemplate"
    ></nz-switch>
    <label style="margin-left: 12px;">Enable Multi edit</label>
    <ng-template #checkedTemplate><i nz-icon nzType="check"></i></ng-template>
    <ng-template #unCheckedTemplate><i nz-icon nzType="close"></i></ng-template>
    <br>

    <button nz-button nzType="primary" nzDanger *ngIf="showCheckMultiple && setOfCheckedId.size !== 0">Reject selected</button>
  </div>

  <nz-pagination
    [nzPageIndex]="(resultPage!.number) + 1"
    [nzPageSize]="resultPage.size"
    [nzTotal]="resultPage.totalElements"
    *ngIf="resultPage && resultPage.totalElements > 0"
    (nzPageIndexChange)="changePage($event)"></nz-pagination>
</div>

