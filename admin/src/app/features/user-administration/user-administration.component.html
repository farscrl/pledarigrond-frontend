<nz-layout class="main-layout">
  <nz-layout class="inner-layout">
    <nz-content>
      <nz-page-header [nzGhost]="false">
        <nz-page-header-title>{{ 'users.title' | translate}}</nz-page-header-title>
        <nz-page-header-extra>
          <button nz-button nzType="primary" (click)="newOrEdit()">{{ 'users.new_button' | translate}}</button>
        </nz-page-header-extra>
      </nz-page-header>

      <nz-collapse>
        <nz-collapse-panel nzHeader="Filter">
          <form nz-form [nzLayout]="'inline'" (ngSubmit)="loadPage(1)">
            <nz-form-item>
              <nz-form-control [nzSpan]="8" [nzFlex]="1"style="min-width: 400px">
                <input nz-input placeholder="Num" [(ngModel)]="searchText" name="name" (ngModelChange)="loadPage(1)" />
              </nz-form-control>
            </nz-form-item>
          </form>
        </nz-collapse-panel>
      </nz-collapse>

      <nz-table #basicTable [nzData]="listOfUsers" [nzFrontPagination]="false" (nzPageIndexChange)="loadPage($event)" [nzTotal]="totalItems" [nzLoading]="isLoading">
        <thead>
          <tr>
            <th>{{ 'users.email' | translate}}</th>
            <th nzAlign="center">{{ 'users.admin' | translate}}</th>
            <th nzAlign="center" *ngIf="environmentService.isLadin()">PT</th>
            <th nzAlign="center" *ngIf="!environmentService.isLadin()">RG</th>
            <th nzAlign="center" *ngIf="!environmentService.isLadin()">SM</th>
            <th nzAlign="center" *ngIf="!environmentService.isLadin()">SR</th>
            <th nzAlign="center" *ngIf="!environmentService.isLadin()">ST</th>
            <th nzAlign="center" *ngIf="environmentService.isLadin()">VL</th>
            <th nzAlign="center" *ngIf="!environmentService.isLadin()">{{ 'users.names' | translate}}</th>
            <th nzAlign="center">{{ 'users.registrations' | translate}}</th>
            <th nzAlign="center">{{ 'users.actions' | translate}}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of basicTable.data">
            <td>{{ data.email }}</td>
            <td nzAlign="center" class="admin-icon" [class.is-admin]="data.admin"><i nz-icon nzType="check-circle" nzTheme="outline" *ngIf="data.admin"></i><i nz-icon nzType="stop" nzTheme="outline" *ngIf="!data.admin"></i></td>
            <td nzAlign="center" *ngIf="environmentService.isLadin()"><app-user-role [role]="data.roles.rolePuter"></app-user-role></td>
            <td nzAlign="center" *ngIf="!environmentService.isLadin()"><app-user-role [role]="data.roles.roleRumantschGrischun"></app-user-role></td>
            <td nzAlign="center" *ngIf="!environmentService.isLadin()"><app-user-role [role]="data.roles.roleSurmiran"></app-user-role></td>
            <td nzAlign="center" *ngIf="!environmentService.isLadin()"><app-user-role [role]="data.roles.roleSursilvan"></app-user-role></td>
            <td nzAlign="center" *ngIf="!environmentService.isLadin()"><app-user-role [role]="data.roles.roleSutsilvan"></app-user-role></td>
            <td nzAlign="center" *ngIf="environmentService.isLadin()"><app-user-role [role]="data.roles.roleVallader"></app-user-role></td>
            <td nzAlign="center" *ngIf="!environmentService.isLadin()"><app-user-role [role]="data.roles.roleNames"></app-user-role></td>
            <td nzAlign="center"><app-user-role [role]="data.roles.roleRegistrations"></app-user-role></td>
            <td nzAlign="center">
              <a (click)="newOrEdit(data.email)">{{ 'users.edit_action' | translate}}</a>
              <nz-divider nzType="vertical"></nz-divider>
              <a (click)="delete(data.email)">{{ 'users.delete_action' | translate}}</a>
            </td>
          </tr>
        </tbody>
      </nz-table>
    </nz-content>
  </nz-layout>
</nz-layout>
