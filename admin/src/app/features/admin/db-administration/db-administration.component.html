<nz-page-header [nzGhost]="false">
  <nz-page-header-title>Database</nz-page-header-title>
  <nz-page-header-subtitle>Database administration</nz-page-header-subtitle>
  <nz-page-header-extra>
    <button nz-button nzType="primary" (click)="exportDb()" [nzLoading]="isDownloadingDb">Backup</button>
    <button nz-button nzNoAnimation nz-dropdown [nzDropdownMenu]="menu" style="border: none; padding: 0" nzPlacement="bottomRight">
      <i nz-icon nzType="ellipsis" nzTheme="outline" style="font-size: 20px; vertical-align: top;"></i>
    </button>
    <nz-dropdown-menu #menu="nzDropdownMenu">
      <ul nz-menu>
        <li nz-menu-item nzDanger>Import</li>
        <li nz-menu-item nzDanger (click)="reloadDemoData()" [nzDisabled]="isReloadingDemoData">Reload Demo-Data</li>
        <li nz-menu-item nzDanger>Drop</li>
      </ul>
    </nz-dropdown-menu>
  </nz-page-header-extra>
</nz-page-header>

<nz-card class="stats-card">
  <nz-row [nzGutter]="16">
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfEntries| number)!" [nzTitle]="'Entries'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfLemmata| number)!" [nzTitle]="'Versions'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfApproved| number)!" [nzTitle]="'Approved'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfSuggestions| number)!" [nzTitle]="'Suggested'"></nz-statistic>
    </nz-col>
  </nz-row>
  <nz-row [nzGutter]="16">
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfDeleted| number)!" [nzTitle]="'Deleted'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfOutdated| number)!" [nzTitle]="'Outdated'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="6">
      <nz-statistic [nzValue]="(dbInfos.numberOfUndefined| number)!" [nzTitle]="'Other'"></nz-statistic>
    </nz-col>
  </nz-row>
  <nz-row [nzGutter]="16">
    <nz-col [nzSpan]="24" style="text-align: right;">
      <button nz-button nzType="primary" (click)="loadDbStats()" [nzLoading]="isLoadingDbInfos">Refresh</button>
    </nz-col>
  </nz-row>
</nz-card>


<nz-page-header [nzGhost]="false">
  <nz-page-header-title>Backup</nz-page-header-title>
  <nz-page-header-subtitle>Information about DB backups</nz-page-header-subtitle>
</nz-page-header>

<nz-card class="stats-card">
  <nz-row [nzGutter]="16">
    <nz-col [nzSpan]="12">
      <nz-statistic [nzValue]="backupInfos.triggerTime" [nzTitle]="'Frequency'"></nz-statistic>
      <nz-statistic [nzValue]="(backupInfos.backupNums| number)!" [nzTitle]="'Max backups'"></nz-statistic>
      <nz-statistic [nzValue]="backupInfos.backupLocation" [nzTitle]="'Location'"></nz-statistic>
    </nz-col>
    <nz-col [nzSpan]="12">
      <nz-timeline>
        <nz-timeline-item nzColor="green" *ngFor="let backupInfo of backupInfos.infos">
          <p>
            {{ backupInfo.creationDate }}<br>
            {{ backupInfo.name }}<br>
            Size: {{ backupInfo.size }}<br>
            <a (click)="downloadBackupFile()">Download</a>
          </p>
        </nz-timeline-item>
      </nz-timeline>
    </nz-col>
  </nz-row>
</nz-card>
